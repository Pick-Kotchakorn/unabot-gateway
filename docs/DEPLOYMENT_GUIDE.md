# üöÄ ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡∏∞ Deploy ‡∏£‡∏∞‡∏ö‡∏ö LINE OA Bot

## üìã Table of Contents

1. [‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°](#‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°)
2. [‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏ó‡∏µ‡∏•‡∏∞‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô](#‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏ó‡∏µ‡∏•‡∏∞‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô)
3. [‡∏Å‡∏≤‡∏£ Deploy Web App](#‡∏Å‡∏≤‡∏£-deploy-web-app)
4. [‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ LINE Webhook](#‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤-line-webhook)
5. [‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö](#‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö)
6. [Troubleshooting](#troubleshooting)

---

## üéØ ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°

### ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ:

- ‚úÖ LINE Official Account
- ‚úÖ Google Account
- ‚úÖ LINE Channel Access Token
- ‚úÖ Channel Secret (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ verify signature)

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Å‡∏≤‡∏£:

#### 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á LINE Official Account

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà https://manager.line.biz/
2. ‡∏™‡∏£‡πâ‡∏≤‡∏á Official Account ‡πÉ‡∏´‡∏°‡πà
3. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Channel ID ‡πÅ‡∏•‡∏∞ Channel Secret

#### 2. ‡∏™‡∏£‡πâ‡∏≤‡∏á LINE Messaging API Channel

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà https://developers.line.biz/console/
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Provider ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
3. ‡∏™‡∏£‡πâ‡∏≤‡∏á Channel ‡πÉ‡∏´‡∏°‡πà (Messaging API)
4. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å **Channel Access Token**

---

## üì¶ ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏ó‡∏µ‡∏•‡∏∞‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô

### Step 1: ‡∏™‡∏£‡πâ‡∏≤‡∏á Google Spreadsheet

```
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà https://sheets.google.com
2. ‡∏Ñ‡∏•‡∏¥‡∏Å "‡∏™‡πÄ‡∏õ‡∏£‡∏î‡∏ä‡∏µ‡∏ï‡πÄ‡∏õ‡∏•‡πà‡∏≤"
3. ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠: "LINE OA Database"
4. Copy Spreadsheet ID ‡∏à‡∏≤‡∏Å URL
   
   URL: https://docs.google.com/spreadsheets/d/SPREADSHEET_ID_HERE/edit
```

**‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Spreadsheet ID ‡πÑ‡∏ß‡πâ!**

---

### Step 2: ‡∏™‡∏£‡πâ‡∏≤‡∏á Google Apps Script Project

```
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà https://script.google.com
2. ‡∏Ñ‡∏•‡∏¥‡∏Å "+ ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡πá‡∏Å‡∏ï‡πå‡πÉ‡∏´‡∏°‡πà"
3. ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠: "LINE OA Bot"
```

---

### Step 3: ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏ü‡∏•‡πå‡πÇ‡∏Ñ‡πâ‡∏î

‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ô‡∏µ‡πâ:

```
1. Config.gs
2. Main.gs
3. EventHandler.gs
4. LineAPI.gs
5. SheetService.gs
6. FollowerService.gs
7. InsightConfig.gs
8. InsightService.gs
9. InsightDashboard.gs
10. Utils.gs
```

**‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:** ‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå `Code.gs` ‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏°‡∏≤‡πÉ‡∏´‡πâ‡∏≠‡∏≠‡∏Å

---

### Step 4: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Configuration

‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏ü‡∏•‡πå **Config.gs**:

```javascript
const LINE_CONFIG = {
  // ‚≠ê ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
  CHANNEL_ACCESS_TOKEN: 'YOUR_ACTUAL_CHANNEL_ACCESS_TOKEN_HERE',
  // ...
};

const SHEET_CONFIG = {
  // ‚≠ê ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
  SPREADSHEET_ID: 'YOUR_SPREADSHEET_ID_HERE',
  // ...
};
```

**‡∏ß‡∏¥‡∏ò‡∏µ‡∏´‡∏≤ Channel Access Token:**
```
1. ‡πÄ‡∏Ç‡πâ‡∏≤ LINE Developers Console
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Channel ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
3. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Messaging API > Channel access token
4. ‡∏Ñ‡∏•‡∏¥‡∏Å "Issue" ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ token ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
```

---

### Step 5: Save ‡πÅ‡∏•‡∏∞ Initialize

```javascript
// 1. ‡∏Å‡∏î Ctrl+S ‡∏´‡∏£‡∏∑‡∏≠ Cmd+S ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å

// 2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô initializeSystem ‡∏à‡∏≤‡∏Å dropdown
// 3. ‡∏Ñ‡∏•‡∏¥‡∏Å "Run" (‚ñ∂Ô∏è)

// 4. ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å Google ‡∏à‡∏∞‡∏Ç‡∏≠ Permission:
//    - ‡∏Ñ‡∏•‡∏¥‡∏Å "Review permissions"
//    - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Account ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
//    - ‡∏Ñ‡∏•‡∏¥‡∏Å "Advanced"
//    - ‡∏Ñ‡∏•‡∏¥‡∏Å "Go to LINE OA Bot (unsafe)"
//    - ‡∏Ñ‡∏•‡∏¥‡∏Å "Allow"
```

**‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Log:**
```
View > Logs (‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏î Ctrl+Enter)
```

‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô:
```
‚úÖ All configuration validated successfully
‚úÖ Sheets initialized
‚úÖ System initialization completed!
```

---

## üåê ‡∏Å‡∏≤‡∏£ Deploy Web App

### Step 1: Deploy

```
1. ‡∏Ñ‡∏•‡∏¥‡∏Å "Deploy" > "New deployment"
2. ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô ‚öôÔ∏è > ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "Web app"

3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤:
   - Description: "LINE Webhook v1.0"
   - Execute as: "Me"
   - Who has access: "Anyone"

4. ‡∏Ñ‡∏•‡∏¥‡∏Å "Deploy"
5. Copy "Web app URL" ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ
```

**Web App URL ‡∏à‡∏∞‡∏°‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏≤‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ:**
```
https://script.google.com/macros/s/XXXX.../exec
```

---

### Step 2: Test Web App

‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ Deploy ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà:

```javascript
// ‡∏£‡∏±‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô
testWebhook()

// ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Log ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô:
// ‚úÖ Webhook test completed!
```

---

## üì± ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ LINE Webhook

### Step 1: ‡πÄ‡∏Ç‡πâ‡∏≤ LINE Developers Console

```
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà https://developers.line.biz/console/
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Provider ‡πÅ‡∏•‡∏∞ Channel ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
3. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πá‡∏ö "Messaging API"
```

---

### Step 2: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Webhook URL

```
1. Scroll ‡∏•‡∏á‡πÑ‡∏õ‡∏´‡∏≤ "Webhook settings"
2. ‡∏Ñ‡∏•‡∏¥‡∏Å "Edit"
3. ‡πÉ‡∏™‡πà Web App URL ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å Deploy
4. ‡∏Ñ‡∏•‡∏¥‡∏Å "Update"

5. ‡πÄ‡∏õ‡∏¥‡∏î‡∏™‡∏ß‡∏¥‡∏ï‡∏ä‡πå "Use webhook" ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß
```

---

### Step 3: Verify Webhook

```
1. ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° "Verify"
2. ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô "Success" ‚úÖ

‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ Web App URL ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ Permission ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- ‡∏î‡∏π Logs ‡πÉ‡∏ô Apps Script
```

---

### Step 4: ‡∏õ‡∏¥‡∏î Auto-reply

```
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà LINE Official Account Manager
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Account ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
3. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà "‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤" > "‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö"
4. ‡∏õ‡∏¥‡∏î "‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥" (‡πÄ‡∏ß‡πâ‡∏ô‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ)
```

---

## ‚úÖ ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö

### Test 1: ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°

```javascript
// 1. ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà TEST_USER_ID ‡∏î‡πâ‡∏ß‡∏¢ User ID ‡∏à‡∏£‡∏¥‡∏á
const testUserId = 'U1234567890abcdef1234567890abcdef';

// 2. ‡∏£‡∏±‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô
pushSimpleMessage(testUserId, 'üß™ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö');

// 3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô LINE ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
```

**‡∏ß‡∏¥‡∏ò‡∏µ‡∏´‡∏≤ User ID:**
```
1. ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏î‡πÜ ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Bot
2. ‡πÄ‡∏õ‡∏¥‡∏î Google Sheets > Conversations
3. ‡∏î‡∏π Column "User ID"
```

---

### Test 2: ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Follow Event

```
1. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô LINE OA ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà‡∏ñ‡πâ‡∏≤‡πÄ‡∏Ñ‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß)
2. ‡πÄ‡∏ä‡πá‡∏Ñ Google Sheets > Followers
3. ‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏õ‡∏£‡∏≤‡∏Å‡∏è
```

---

### Test 3: ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Echo Message

```
1. ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏∞‡πÑ‡∏£‡∏Å‡πá‡πÑ‡∏î‡πâ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Bot
2. Bot ‡∏Ñ‡∏ß‡∏£‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° Echo:
   "üì© ‡∏Ñ‡∏∏‡∏ì‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤: ..."
3. ‡πÄ‡∏ä‡πá‡∏Ñ Google Sheets > Conversations
4. ‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏ó‡∏ô‡∏≤
```

---

### Test 4: Health Check

```javascript
// ‡∏£‡∏±‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô
healthCheck()

// ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô:
// ‚úÖ Configuration: Valid
// ‚úÖ Spreadsheet Access: Connected
// ‚úÖ LINE API Token: Configured
// ‚úÖ All systems operational!
```

---

## üîß Troubleshooting

### ‚ùå ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Webhook Verify ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:**
- Web App URL ‡∏ú‡∏¥‡∏î
- Permission ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- Script ‡∏°‡∏µ Error

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
```javascript
// 1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Configuration
validateConfig()

// 2. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Webhook
testWebhook()

// 3. ‡∏î‡∏π Logs ‡∏ß‡πà‡∏≤‡∏°‡∏µ Error ‡∏≠‡∏∞‡πÑ‡∏£
// View > Logs
```

---

### ‚ùå ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Bot ‡πÑ‡∏°‡πà‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:**
- Webhook ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
- Access Token ‡∏ú‡∏¥‡∏î
- Auto-reply ‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
```javascript
// 1. Test LINE API
testLineAPI()

// 2. ‡∏î‡∏π Execution Log
// Apps Script > Executions

// 3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ doPost() ‡∏ñ‡∏π‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
```

---

### ‚ùå ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Permission Denied

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:**
- Spreadsheet ID ‡∏ú‡∏¥‡∏î
- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á Spreadsheet

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
```
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Spreadsheet ID ‡πÉ‡∏ô Config.gs
2. ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ Account ‡∏ó‡∏µ‡πà Deploy ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö Owner ‡∏Ç‡∏≠‡∏á Spreadsheet
3. ‡∏•‡∏≠‡∏á Deploy ‡πÉ‡∏´‡∏°‡πà
```

---

### ‚ùå ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Data ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
```javascript
// 1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Sheet Structure
testSheetService()

// 2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ Sheet ‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á
initializeSheets()

// 3. ‡∏•‡∏≠‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏î‡∏™‡∏≠‡∏ö
saveConversation({
  userId: 'TEST',
  userMessage: 'Test',
  aiResponse: 'Test',
  intent: 'test',
  timestamp: new Date()
})
```

---

## üéØ Next Steps

‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å Deploy ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß:

### 1. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Analytics (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)

```javascript
// ‡∏™‡∏£‡πâ‡∏≤‡∏á Insight Line Sheet
createInsightLineSheet()

// Import ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å LINE Manager
// ‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏±‡∏ô
syncInsightData()
```

### 2. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Auto-sync

```javascript
// Dashboard ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô
setupDashboardSchedule()
```

### 3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏µ‡πÄ‡∏°‡∏•

```javascript
// ‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå
emailDashboard('your-email@example.com')
```

---

## üìû ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠?

‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á:

1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö [Troubleshooting](#troubleshooting) ‡∏Å‡πà‡∏≠‡∏ô
2. ‡∏î‡∏π Logs ‡πÉ‡∏ô Apps Script
3. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞ Component ‡∏î‡πâ‡∏ß‡∏¢‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô test
4. ‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡πÉ‡∏ô LINE Group: @yourgroup

---

**Good Luck! üöÄ**
